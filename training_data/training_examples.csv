question,sql,description,created_at,updated_at
What is the total revenue in 2025->,SELECT SUM(umsatz_eur) AS total_revenue_eur FROM ticket_verkaeufe WHERE jahr = 2025;,,,
Show revenue per month for 2024.,"SELECT monat, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE jahr = 2024 GROUP BY monat ORDER BY monat;",,,
How many tickets were sold in total->,SELECT SUM(anzahl) AS total_tickets FROM ticket_verkaeufe;,,,
Which ticket products exist->,"SELECT ticket_code, ticket_name, preis_eur FROM ticket_produkte ORDER BY ticket_name;",,,
List all tariff associations.,"SELECT tarifverbund_id, name, kuerzel, status FROM tarifverbuende ORDER BY name;",,,
Which tariff associations are active->,"SELECT tarifverbund_id, name, kuerzel FROM tarifverbuende WHERE status = 'aktiv' ORDER BY name;",,,
List all federal states.,"SELECT bundesland_code2, bundesland_name, iso_code FROM regionen_bundesland ORDER BY bundesland_name;",,,
Which reporting offices exist->,"SELECT meldestelle_code, meldestelle_name FROM meldestellen ORDER BY meldestelle_name;",,,
How many reporting offices per city (from the name)->,"SELECT split_part(meldestelle_name, ' ', 1) AS city_token, COUNT(*) AS office_count FROM meldestellen GROUP BY city_token ORDER BY office_count DESC;",,,
Which ticket types were sold the most (by quantity)->,"SELECT tp.ticket_name, SUM(tv.anzahl) AS tickets_sold FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code GROUP BY tp.ticket_name ORDER BY tickets_sold DESC;",,,
Which ticket types generate the most revenue->,"SELECT tp.ticket_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code GROUP BY tp.ticket_name ORDER BY revenue_eur DESC;",,,
Show revenue by tariff association.,"SELECT t.name AS tarifverbund, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id GROUP BY t.name ORDER BY revenue_eur DESC;",,,
Show revenue by reporting office.,"SELECT m.meldestelle_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN meldestellen m ON tv.meldestelle_code = m.meldestelle_code GROUP BY m.meldestelle_name ORDER BY revenue_eur DESC;",,,
Show revenue by postal code.,"SELECT tv.plz, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv GROUP BY tv.plz ORDER BY revenue_eur DESC;",,,
Show top 10 postal codes by revenue.,"SELECT tv.plz, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv GROUP BY tv.plz ORDER BY revenue_eur DESC LIMIT 10;",,,
Show revenue by federal state (via postal code).,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY revenue_eur DESC;",,,
For 2025: revenue per state and per month.,"SELECT r.bundesland_name, tv.monat, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE tv.jahr = 2025 GROUP BY r.bundesland_name, tv.monat ORDER BY r.bundesland_name, tv.monat;",,,
Which states have the highest revenue->,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY revenue_eur DESC LIMIT 5;",,,
Which states have the most tickets sold->,"SELECT r.bundesland_name, SUM(tv.anzahl) AS tickets_sold FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY tickets_sold DESC LIMIT 5;",,,
"Per state, show top 3 ticket types by revenue.","WITH revenue_by_state AS (SELECT r.bundesland_name, tp.ticket_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name, tp.ticket_name), ranked AS (SELECT *, ROW_NUMBER() OVER (PARTITION BY bundesland_name ORDER BY revenue_eur DESC) AS rn FROM revenue_by_state) SELECT bundesland_name, ticket_name, revenue_eur FROM ranked WHERE rn <= 3 ORDER BY bundesland_name, revenue_eur DESC;",,,
"For each tariff association, show revenue by state.","SELECT t.name AS tarifverbund, r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY t.name, r.bundesland_name ORDER BY t.name, revenue_eur DESC;",,,
"For each ticket type, show revenue by state.","SELECT tp.ticket_name, r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY tp.ticket_name, r.bundesland_name ORDER BY tp.ticket_name, revenue_eur DESC;",,,
State ranking: revenue per state in 2024.,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE tv.jahr = 2024 GROUP BY r.bundesland_name ORDER BY revenue_eur DESC;",,,
Which postal codes belong to which state->,"SELECT p.plz, p.ort, r.bundesland_name FROM postleitzahlen p JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 ORDER BY p.plz;",,,
"Show postal code, city, and state for the top 20 revenues.","SELECT p.plz, p.ort, r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY p.plz, p.ort, r.bundesland_name ORDER BY revenue_eur DESC LIMIT 20;",,,
Show revenue in Bavaria by ticket type.,"SELECT tp.ticket_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE r.bundesland_name = 'Bayern' GROUP BY tp.ticket_name ORDER BY revenue_eur DESC;",,,
Show revenue in Berlin by month.,"SELECT tv.jahr, tv.monat, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE r.bundesland_name = 'Berlin' GROUP BY tv.jahr, tv.monat ORDER BY tv.jahr, tv.monat;",,,
Which cities have the highest revenue->,"SELECT p.ort, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz GROUP BY p.ort ORDER BY revenue_eur DESC;",,,
Show revenue by city (via postal code).,"SELECT p.ort, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz GROUP BY p.ort ORDER BY revenue_eur DESC;",,,
Which reporting offices deliver the most revenue in NRW->,"SELECT m.meldestelle_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN meldestellen m ON tv.meldestelle_code = m.meldestelle_code JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE r.bundesland_name = 'Nordrhein-Westfalen' GROUP BY m.meldestelle_name ORDER BY revenue_eur DESC;",,,
Show reporting office revenue and its state.,"SELECT m.meldestelle_name, r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN meldestellen m ON tv.meldestelle_code = m.meldestelle_code JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY m.meldestelle_name, r.bundesland_name ORDER BY revenue_eur DESC;",,,
Which tariff associations are especially strong in which states->,"WITH revenue_by_state AS (SELECT t.name AS tarifverbund, r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY t.name, r.bundesland_name), ranked AS (SELECT *, ROW_NUMBER() OVER (PARTITION BY tarifverbund ORDER BY revenue_eur DESC) AS rn FROM revenue_by_state) SELECT tarifverbund, bundesland_name, revenue_eur FROM ranked WHERE rn <= 3 ORDER BY tarifverbund, revenue_eur DESC;",,,
Show ticket sales (quantity) per state.,"SELECT r.bundesland_name, SUM(tv.anzahl) AS tickets_sold FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY tickets_sold DESC;",,,
Show average price per ticket type (from sales) and compare to ticket_produkte.,"SELECT tp.ticket_name, SUM(tv.umsatz_eur) / NULLIF(SUM(tv.anzahl), 0) AS avg_sale_price_eur, tp.preis_eur AS catalog_price_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code GROUP BY tp.ticket_name, tp.preis_eur ORDER BY tp.ticket_name;",,,
Find postal codes with very high revenue and show the state.,"SELECT p.plz, r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY p.plz, r.bundesland_name ORDER BY revenue_eur DESC LIMIT 10;",,,
Show revenue trend per month from 2024 to 2025.,"SELECT jahr, monat, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE jahr IN (2024, 2025) GROUP BY jahr, monat ORDER BY jahr, monat;",,,
Which month has the highest revenue->,"SELECT jahr, monat, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe GROUP BY jahr, monat ORDER BY revenue_eur DESC LIMIT 1;",,,
Which month has the most ticket sales->,"SELECT jahr, monat, SUM(anzahl) AS tickets_sold FROM ticket_verkaeufe GROUP BY jahr, monat ORDER BY tickets_sold DESC LIMIT 1;",,,
Show revenue per quarter.,"SELECT jahr, ((monat - 1) / 3)::INT + 1 AS quarter, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe GROUP BY jahr, quarter ORDER BY jahr, quarter;",,,
"Show revenue per week (if possible, otherwise explain why not).","SELECT date_part('year', gueltig_ab) AS jahr, date_part('week', gueltig_ab) AS week, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE gueltig_ab IS NOT NULL GROUP BY jahr, week ORDER BY jahr, week;",,,
Show revenue for January 2025.,SELECT SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE jahr = 2025 AND monat = 1;,,,
Show revenue for Q2 2024.,"SELECT SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE jahr = 2024 AND monat IN (4, 5, 6);",,,
Compare 2024 vs 2025: revenue per month side-by-side.,"SELECT monat, SUM(CASE WHEN jahr = 2024 THEN umsatz_eur ELSE 0 END) AS revenue_2024, SUM(CASE WHEN jahr = 2025 THEN umsatz_eur ELSE 0 END) AS revenue_2025 FROM ticket_verkaeufe WHERE jahr IN (2024, 2025) GROUP BY monat ORDER BY monat;",,,
Which ticket type grows the most from 2024 to 2025->,"SELECT tp.ticket_name, SUM(CASE WHEN tv.jahr = 2025 THEN tv.umsatz_eur ELSE 0 END) - SUM(CASE WHEN tv.jahr = 2024 THEN tv.umsatz_eur ELSE 0 END) AS revenue_growth FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code WHERE tv.jahr IN (2024, 2025) GROUP BY tp.ticket_name ORDER BY revenue_growth DESC LIMIT 1;",,,
Show top 5 months by revenue in 2025.,"SELECT monat, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE jahr = 2025 GROUP BY monat ORDER BY revenue_eur DESC LIMIT 5;",,,
Show the revenue trend for Deutschlandticket over time.,"SELECT tv.jahr, tv.monat, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code WHERE tp.ticket_name ILIKE '%deutschlandticket%' GROUP BY tv.jahr, tv.monat ORDER BY tv.jahr, tv.monat;",,,
Are there seasonal peaks (summer/Christmas)->,"SELECT monat, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe GROUP BY monat ORDER BY monat;",,,
Which states have the highest revenue in summer 2025->,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE tv.jahr = 2025 AND tv.monat IN (6, 7, 8) GROUP BY r.bundesland_name ORDER BY revenue_eur DESC;",,,
Show December 2024 revenue by state.,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE tv.jahr = 2024 AND tv.monat = 12 GROUP BY r.bundesland_name ORDER BY revenue_eur DESC;",,,
Which combination (ticket type + month) generates the most revenue->,"SELECT tp.ticket_name, tv.jahr, tv.monat, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code GROUP BY tp.ticket_name, tv.jahr, tv.monat ORDER BY revenue_eur DESC LIMIT 1;",,,
Show top 10 combinations (tariff association + month) by revenue.,"SELECT t.name AS tarifverbund, tv.jahr, tv.monat, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id GROUP BY t.name, tv.jahr, tv.monat ORDER BY revenue_eur DESC LIMIT 10;",,,
Show average monthly revenue for 2024 and 2025.,"WITH monthly AS (SELECT jahr, monat, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE jahr IN (2024, 2025) GROUP BY jahr, monat) SELECT jahr, AVG(revenue_eur) AS avg_monthly_revenue_eur FROM monthly GROUP BY jahr ORDER BY jahr;",,,
Which months have unusually low revenue (outliers)->,"SELECT jahr, monat, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe GROUP BY jahr, monat ORDER BY revenue_eur ASC LIMIT 5;",,,
Show revenue per month only for active tariff associations.,"SELECT tv.jahr, tv.monat, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id WHERE t.status = 'aktiv' GROUP BY tv.jahr, tv.monat ORDER BY tv.jahr, tv.monat;",,,
Show revenue per month excluding Berlin.,"SELECT tv.jahr, tv.monat, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE r.bundesland_name <> 'Berlin' GROUP BY tv.jahr, tv.monat ORDER BY tv.jahr, tv.monat;",,,
Top 10 tariff associations by revenue.,"SELECT t.name AS tarifverbund, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id GROUP BY t.name ORDER BY revenue_eur DESC LIMIT 10;",,,
Top 10 states by revenue.,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY revenue_eur DESC LIMIT 10;",,,
Top 10 reporting offices by revenue.,"SELECT m.meldestelle_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN meldestellen m ON tv.meldestelle_code = m.meldestelle_code GROUP BY m.meldestelle_name ORDER BY revenue_eur DESC LIMIT 10;",,,
Top 10 postal codes by tickets sold.,"SELECT tv.plz, SUM(tv.anzahl) AS tickets_sold FROM ticket_verkaeufe tv GROUP BY tv.plz ORDER BY tickets_sold DESC LIMIT 10;",,,
Bottom 5 states by revenue.,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY revenue_eur ASC LIMIT 5;",,,
Which ticket types have the lowest sales->,"SELECT tp.ticket_name, SUM(tv.anzahl) AS tickets_sold FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code GROUP BY tp.ticket_name ORDER BY tickets_sold ASC LIMIT 5;",,,
Which tariff associations have the lowest revenue in 2025->,"SELECT t.name AS tarifverbund, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id WHERE tv.jahr = 2025 GROUP BY t.name ORDER BY revenue_eur ASC LIMIT 10;",,,
Which states have the highest average revenue per reporting office->,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) / NULLIF(COUNT(DISTINCT tv.meldestelle_code), 0) AS avg_revenue_per_office FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY avg_revenue_per_office DESC;",,,
Which postal codes have highest revenue per ticket (revenue/quantity)->,"SELECT tv.plz, SUM(tv.umsatz_eur) / NULLIF(SUM(tv.anzahl), 0) AS revenue_per_ticket FROM ticket_verkaeufe tv GROUP BY tv.plz ORDER BY revenue_per_ticket DESC LIMIT 10;",,,
Which ticket type has highest revenue per sold unit->,"SELECT tp.ticket_name, SUM(tv.umsatz_eur) / NULLIF(SUM(tv.anzahl), 0) AS revenue_per_ticket FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code GROUP BY tp.ticket_name ORDER BY revenue_per_ticket DESC LIMIT 1;",,,
Show top 5 cities by revenue.,"SELECT p.ort, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz GROUP BY p.ort ORDER BY revenue_eur DESC LIMIT 5;",,,
Show top 5 states by ticket quantity.,"SELECT r.bundesland_name, SUM(tv.anzahl) AS tickets_sold FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY tickets_sold DESC LIMIT 5;",,,
Show top 5 states by revenue growth (20242025).,"SELECT r.bundesland_name, SUM(CASE WHEN tv.jahr = 2025 THEN tv.umsatz_eur ELSE 0 END) - SUM(CASE WHEN tv.jahr = 2024 THEN tv.umsatz_eur ELSE 0 END) AS revenue_growth FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE tv.jahr IN (2024, 2025) GROUP BY r.bundesland_name ORDER BY revenue_growth DESC LIMIT 5;",,,
Which ticket types are strongest in NRW->,"SELECT tp.ticket_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN ticket_produkte tp ON tv.ticket_code = tp.ticket_code JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE r.bundesland_name = 'Nordrhein-Westfalen' GROUP BY tp.ticket_name ORDER BY revenue_eur DESC;",,,
Which tariff associations are strongest in Bavaria->,"SELECT t.name AS tarifverbund, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE r.bundesland_name = 'Bayern' GROUP BY t.name ORDER BY revenue_eur DESC;",,,
Compare actual revenue (ticket_verkaeufe) with planned revenue (plan_umsatz) per month.,"WITH actual AS (SELECT jahr, monat, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe GROUP BY jahr, monat), plan AS (SELECT jahr, monat, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz GROUP BY jahr, monat) SELECT COALESCE(a.jahr, p.jahr) AS jahr, COALESCE(a.monat, p.monat) AS monat, a.actual_revenue, p.planned_revenue FROM actual a FULL OUTER JOIN plan p ON a.jahr = p.jahr AND a.monat = p.monat ORDER BY jahr, monat;",,,
For 2025: which months are above plan->,"WITH actual AS (SELECT jahr, monat, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe GROUP BY jahr, monat), plan AS (SELECT jahr, monat, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz GROUP BY jahr, monat) SELECT a.jahr, a.monat, a.actual_revenue, p.planned_revenue FROM actual a JOIN plan p ON a.jahr = p.jahr AND a.monat = p.monat WHERE a.jahr = 2025 AND a.actual_revenue > p.planned_revenue ORDER BY a.monat;",,,
For 2025: which months are below plan->,"WITH actual AS (SELECT jahr, monat, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe GROUP BY jahr, monat), plan AS (SELECT jahr, monat, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz GROUP BY jahr, monat) SELECT a.jahr, a.monat, a.actual_revenue, p.planned_revenue FROM actual a JOIN plan p ON a.jahr = p.jahr AND a.monat = p.monat WHERE a.jahr = 2025 AND a.actual_revenue < p.planned_revenue ORDER BY a.monat;",,,
Which tariff associations are above plan in yearly total->,"WITH actual AS (SELECT jahr, tarifverbund_id, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe GROUP BY jahr, tarifverbund_id), plan AS (SELECT jahr, tarifverbund_id, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz GROUP BY jahr, tarifverbund_id) SELECT t.name AS tarifverbund, a.jahr, a.actual_revenue, p.planned_revenue FROM actual a JOIN plan p ON a.jahr = p.jahr AND a.tarifverbund_id = p.tarifverbund_id JOIN tarifverbuende t ON a.tarifverbund_id = t.tarifverbund_id WHERE a.actual_revenue > p.planned_revenue ORDER BY a.jahr, a.actual_revenue - p.planned_revenue DESC;",,,
Show per tariff association the deviation (actual - plan) for 2025.,"WITH actual AS (SELECT tarifverbund_id, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe WHERE jahr = 2025 GROUP BY tarifverbund_id), plan AS (SELECT tarifverbund_id, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz WHERE jahr = 2025 GROUP BY tarifverbund_id) SELECT t.name AS tarifverbund, actual.actual_revenue, plan.planned_revenue, actual.actual_revenue - plan.planned_revenue AS deviation_eur FROM actual JOIN plan ON actual.tarifverbund_id = plan.tarifverbund_id JOIN tarifverbuende t ON actual.tarifverbund_id = t.tarifverbund_id ORDER BY deviation_eur DESC;",,,
Show monthly deviation as a percentage.,"WITH actual AS (SELECT jahr, monat, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe GROUP BY jahr, monat), plan AS (SELECT jahr, monat, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz GROUP BY jahr, monat) SELECT a.jahr, a.monat, (a.actual_revenue - p.planned_revenue) / NULLIF(p.planned_revenue, 0) * 100 AS deviation_pct FROM actual a JOIN plan p ON a.jahr = p.jahr AND a.monat = p.monat ORDER BY a.jahr, a.monat;",,,
Which 5 tariff associations have the largest positive deviation->,"WITH actual AS (SELECT tarifverbund_id, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe WHERE jahr = 2025 GROUP BY tarifverbund_id), plan AS (SELECT tarifverbund_id, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz WHERE jahr = 2025 GROUP BY tarifverbund_id) SELECT t.name AS tarifverbund, actual.actual_revenue - plan.planned_revenue AS deviation_eur FROM actual JOIN plan ON actual.tarifverbund_id = plan.tarifverbund_id JOIN tarifverbuende t ON actual.tarifverbund_id = t.tarifverbund_id ORDER BY deviation_eur DESC LIMIT 5;",,,
Which 5 tariff associations have the largest negative deviation->,"WITH actual AS (SELECT tarifverbund_id, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe WHERE jahr = 2025 GROUP BY tarifverbund_id), plan AS (SELECT tarifverbund_id, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz WHERE jahr = 2025 GROUP BY tarifverbund_id) SELECT t.name AS tarifverbund, actual.actual_revenue - plan.planned_revenue AS deviation_eur FROM actual JOIN plan ON actual.tarifverbund_id = plan.tarifverbund_id JOIN tarifverbuende t ON actual.tarifverbund_id = t.tarifverbund_id ORDER BY deviation_eur ASC LIMIT 5;",,,
Are there months with planned value = 0 (if yes: explain)->,"SELECT jahr, monat, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz GROUP BY jahr, monat HAVING SUM(umsatz_eur) = 0 ORDER BY jahr, monat;",,,
"Show a simple KPI table: month, actual, plan, deviation.","WITH actual AS (SELECT jahr, monat, SUM(umsatz_eur) AS actual_revenue FROM ticket_verkaeufe GROUP BY jahr, monat), plan AS (SELECT jahr, monat, SUM(umsatz_eur) AS planned_revenue FROM plan_umsatz GROUP BY jahr, monat) SELECT COALESCE(a.jahr, p.jahr) AS jahr, COALESCE(a.monat, p.monat) AS monat, a.actual_revenue, p.planned_revenue, (a.actual_revenue - p.planned_revenue) AS deviation_eur FROM actual a FULL OUTER JOIN plan p ON a.jahr = p.jahr AND a.monat = p.monat ORDER BY jahr, monat;",,,
Show revenue by state for 2027.,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 WHERE tv.jahr = 2027 GROUP BY r.bundesland_name ORDER BY revenue_eur DESC;",,,
Show revenue per week for 2025.,"SELECT date_part('week', gueltig_ab) AS week, SUM(umsatz_eur) AS revenue_eur FROM ticket_verkaeufe WHERE jahr = 2025 AND gueltig_ab IS NOT NULL GROUP BY week ORDER BY week;",,,
"Show ticket sales for postal code ""ABCDE"".",SELECT SUM(anzahl) AS tickets_sold FROM ticket_verkaeufe WHERE CAST(plz AS VARCHAR) = 'ABCDE';,,,
Which states are completely missing in sales->,"WITH sales AS (SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name) SELECT r.bundesland_name FROM regionen_bundesland r LEFT JOIN sales s ON r.bundesland_name = s.bundesland_name WHERE s.revenue_eur IS NULL OR s.revenue_eur = 0 ORDER BY r.bundesland_name;",,,
Why is revenue so high in month X->,"SELECT t.name AS tarifverbund, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN tarifverbuende t ON tv.tarifverbund_id = t.tarifverbund_id WHERE tv.jahr = 2025 AND tv.monat = 6 GROUP BY t.name ORDER BY revenue_eur DESC LIMIT 10;",,,
Give me all data (everything).,SELECT 'Request too broad; please ask a specific question.' AS message;,,,
Please insert new data.,SELECT 'Refused: read-only database.' AS message;,,,
Delete all rows from ticket_verkaeufe.,SELECT 'Refused: read-only database.' AS message;,,,
Show personal data of users.,SELECT 'Synthetic demo data only; personal data not provided.' AS message;,,,
Explain which tables I need to join to get revenue by state.,"SELECT r.bundesland_name, SUM(tv.umsatz_eur) AS revenue_eur FROM ticket_verkaeufe tv JOIN postleitzahlen p ON CAST(tv.plz AS VARCHAR) = p.plz JOIN regionen_bundesland r ON p.bundesland_code2 = r.bundesland_code2 GROUP BY r.bundesland_name ORDER BY revenue_eur DESC;",,,
